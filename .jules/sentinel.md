## 2024-05-23 - SSRF Protection Implementation
**Vulnerability:** The `URLScraper` class in `src/url_scraper.py` used `requests.get` directly on user-supplied URLs without validating the target IP address. This allowed attackers to perform Server-Side Request Forgery (SSRF) attacks by directing the analyzer to fetch content from internal services (localhost, private subnets, cloud metadata).
**Learning:** `requests.get` follows redirects by default and does not validate destination IPs. While convenient, this is dangerous for security tools that fetch untrusted URLs. A "check-then-act" pattern is required, where the hostname is resolved and validated *before* the request. Furthermore, redirects must be handled manually to validate each hop in the chain, as an initial safe URL could redirect to an unsafe internal one.
**Prevention:** Always validate the resolved IP address of any user-supplied URL against private/reserved ranges before connecting. Disable automatic redirects (`allow_redirects=False`) and validate the location of every redirect response recursively.

## 2024-05-23 - SSRF Protection Implementation
**Vulnerability:** The `URLScraper` class in `src/url_scraper.py` used `requests.get` to fetch URLs without validating the destination IP address. This allowed an attacker to supply a URL pointing to internal network resources (e.g., `localhost`, `169.254.169.254`), leading to Server-Side Request Forgery (SSRF).
**Learning:** `requests` automatically follows redirects by default. Validating only the initial URL is insufficient because a malicious server can redirect to a private IP. Disabling redirects (`allow_redirects=False`) and handling them manually is required to check the IP at every hop. Also, `requests.get` downloads the entire response body by default, which can lead to DoS if the file is large; using `stream=True` and checking `len(content)` incrementally is safer.
**Prevention:** Always validate the resolved IP address against private/reserved ranges before making a request. If following redirects, validate the IP for every new location header. Use `stream=True` to enforce size limits on the response body.
